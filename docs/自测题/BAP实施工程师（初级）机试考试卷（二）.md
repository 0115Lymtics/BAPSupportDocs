**本试卷满分100分，60分为合格。**

1、 完成安装BAP所有的应用以及sql server 2008，并且配置完成能够登录一个数据库。（5分）

2、 将采购订单和销售订单添加至用户菜单，并且所属文件夹取名为（常用菜单）。（5分）

3、 在系统内，配置三个物料主数据，然后将三个物料主数据编成BOM，依据销售订单进行MRP运算，然后成功转换为一个生产订单和一个采购订单。（10分）

4、 在系统内完成一个采购流程（采购订单-采购收货-应付发票-预付款-清帐付款（以银行的方式付款））。（10分）

5、 运用用户搜索，配置一个默认的计量单位（米）。（5分）

6、 在采购订单明细行增加一个长度字段，一个高度字段，一个宽度字段，一个体积字段，并且运用用户搜索配置自动计算，体积=长度*高度*宽度。（5分）

7、 在采购订单明细行，配置不含税单价>1000，字体变为红色。（5分）

8、 在系统内配置一个报表（在托查询内显示），字段为（采购订单号、采购订单数量，采购交货日期，采购收货单号，采购收货数量）采购订单号字段和采购收货单号超链接，并且配置一个根据采购交货日期筛选的条件。（10分）

9、 在系统内采购订单明细行、采购收货明细行、应付发票明细行增加一个字段：业务员；不用用户搜索功能在系统内将业务员信息能够从采购订单自动下推到采购收货以及应付发票。（10分）

10、 完成自制生产订单流程（发货方式为倒冲的流程）。（5分）

11、 完成委外生产订单流程，加分项：财务凭证正确。（5分）

12、 在系统内完成销售赠送流程，加分项：财务凭证正确。（5分）

13、 在系统内完成一个固定资产主数据建立，购置，同一费用类型转移，普通折旧，无收入报废，加分项：财务凭证正确。（10分）

14、 运用存储过程编写控制：采购收货不经过采购收货通知不允许保存。（10分）

**附加题（15分）**

15、 运用存储过程将系统内库存发货进行科目干预，形成生产发货的财务凭证。

 

 



### **答案**

1.

BAP Business Cloud客户端安装的步骤如下：

步骤1：双击【BAP Buiness Cloud 安装.msi】，运行安装程序；

步骤2：阅读BAP Business Cloud安装向导，点击【下一步】进入【选择安装文件夹】界面；

步骤3：选择完成安装路径和策略后，点击【下一步】进入【确认安装】界面；

步骤4：点击【下一步】开始进行BAP Business Cloud安装；

步骤5：完成完成后，点击【关闭】退出安装程序界面

BAP Business Cloud消息服务器安装的步骤如下：

步骤1：双击【BAP Buiness Cloud消息服务器.msi】，运行安装程序；

步骤2：阅读BAP Business Cloud消息服务器安装向导，点击【下一步】进入【选择安装文件夹】界面；

步骤3：选择完成安装路径和策略后，点击【下一步】进入【确认安装】界面；

步骤4：点击【下一步】开始进行BAP Business Cloud消息服务器安装；

步骤5：点击【关闭】退出安装程序

BAP Business Cloud数据库管理器安装的步骤如下：

步骤1：双击【BAP Buiness Cloud数据库管理器.msi】，运行安装程序；

步骤2：阅读BAP Business Cloud数据库管理器安装向导，点击【下一步】进入【选择安装文件夹】界面；

步骤3：选择完成安装路径和策略后，点击【下一步】进入【确认安装】界面；

步骤4：点击【下一步】开始进行BAP Business Cloud数据库管理器安装；

步骤5：点击【关闭】退出安装程序。

BAP Business Cloud服务管理器安装的步骤如下：

步骤1：双击【BAP Buiness Cloud服务管理器.msi】，运行安装程序；

步骤2：阅读BAP Business Cloud服务管理器安装向导，点击【下一步】进入【选择安装文件夹】界面；

步骤3：选择完成安装路径和策略后，点击【下一步】进入【确认安装】界面；

步骤4：点击【下一步】开始进行BAP Business Cloud服务管理器安装；

步骤5：点击【关闭】退出安装程序。

ql server 2008数据库安装的步骤如下：

步骤1：双击sql server 2008的.exe安装文件，进入【SQL Server 安装中心】。

步骤2：点击界面左侧的【安装】，然后点击右侧的【全新SQL Server 独立安装或向现有安装添加功能】，进入【SQL Server 2008 安装程序】界面，首先是【安装程序支持规则】，操作完成之后，点击【确定】。

步骤3：进入【产品密钥】，选择合适的版本，点击【下一步】进入【许可条款】，勾选上【我接受许可条款】，直接点击【下一步】进入【许可条款】，勾选上【我接受许可条款】，直接点击【下一步】。

步骤4：进入【安装程序支持文件】，点击【安装】按钮，开始安装支持文件。

步骤5：安装完成之后，又进入【安装程序支持规则】，点击【显示详细信息】可以看到详细的规则列表，点击【下一步】。

步骤7：进入【功能选择】，这里我选择了【全选】，也可以选择具体需要的功能，并且可以改变安装位置，设置完成后，点击【下一步】。

步骤8：进入【实例配置】，这里我直接选择了【命名实例】，其他都按照默认设置，点击【下一步】。

步骤9：进入【磁盘空间要求】，显示磁盘的使用情况，可以直接点击【下一步】。

步骤10：进入【服务器配置】，单击【对所有SQL Server 服务使用相同的账户】，选择了【NT AUTHORITY\SYSTEM】,然后单击【下一步】即可。

步骤11：进入【数据库引擎配置】，单击【添加当前用户】指定SQL Server管理员，这样管理员就是系统管理员，设置好之后，直接单击【下一步】。

步骤12：进入【Reporting Services配置】，直接按照默认选择第一项，点击【下一步】。

步骤13：进入【错误和使用情况报告】，可以选择其中一项，将相关内容发送给Mircosoft，也可以不进行选择，然后单击【下一步】。

步骤14：进入【安装规则】，直接单击【下一步】。

步骤15：进入【安装进度】，SQL Server 2008开始安装，不用管它，等待安装完成即可。安装完成后，会列出具体安装了哪些功能，提示安装过程完成，这时单击【下一步】，可进入【完成】界面，提示【SQL Server 2008安装已成功完成】

能够登录一个数据库的步骤如下：

步骤1：双击BAP Business Cloud数据库管理器进入界面，添加的服务器、用户名、密码与登录的ql server 2008数据库要一致，点击确认；

步骤2：进入创建数据库界面，点击创建范围进行创建新的数据库并填写必要的信息，最后点击确认

 

2.  

（1）打开【销售】—【订单】，右击【销售订单】，点击“added to the user menu”

（2）打开【采购】—【订单】，右击【采购订单】，点击“added to the user menu”

（3）点击【文件】—【整理用户菜单】—【重命名】，将名称改为“常用菜单”

3.

（1）创建销售订单，点击“添加”，保存后发起审批。

（2）打开【计划】—【物料需求计划运算】，

（3）选择公司代码，点击【下一步】。

（4）选择【创建新方案】，点击【下一步】

（5）填写【方案名称】、【描述】、【工厂】，在【控制】界面下勾选【生计划考虑假期】、【采购计划考虑假期】、【生产订单产出】、【采购订单】、【包括未下达1行】、【包括未审批3行】

（6.）在【需求】界面下，勾选【销售订单需求】

（7）在【限制】界面下，选择‘订单类型’为‘销售订单’，点击【查询订单】，选择刚刚创建的销售订单。

（8）在【库存】界面下，勾选‘当前库存’，选择仓库代码。

（9）点击【运行】，点击【保存方案】，点击【保存结果】，点击完成。

（10）打开【计划】—【生产或采购建议】，勾选‘生产订单’、‘采购订单’，点击【确定】

（11）选中需要转换的订单，点击【转换】

4.

（1）打开【采购】—【申请与订单】—【采购订单】，选择供应商，输入需要采购的物料号、数量、交货日期等。点击【添加】，然后点击【发起审批】，然后点击【创建为…】，选择‘采购收货单’

（2）在‘采购收货单’中，点击【添加】后发起审批，点击【过账】，点击【创建为…】，选择‘应付发票’

（3）在‘应付发票’界面中，点击【添加】后发起审批，点击【创建为…】，选择‘付款’，点击【清账】，选择相应的凭证，在‘付款清账’界面，点击‘钱袋’，选择付款方式，成功付款后，回到付款清账界面，点击【分配】，勾选下方的【激活】，点击【确定】

5.

（1）打开【库存】—【物料主数据】，将光标移动到‘基本计量单位’上，打开【工具】—【用户搜索】—【定义】，选择【按已经保存的查询搜索】，点击【公式】，在下方输入公式名称和公式组别，在公式内容中输入：‘米’。 点击【添加】。在【定义用户搜索】界面中，选择刚刚定义的公式，勾选【自动更新】，下方选择【title 物料号】，点击【确定】

（2.）回到【物料主数据】界面，输入物料号，系统在‘基本计量单位’中，自动跳出来‘米’

6.

（1）打开【采购】—【申请与订单】—【采购订单】，选择【表格设计】，找到‘长度’、‘高度’、‘宽度’、‘体积’将相应的‘显示’勾选出来。

（2）将光标移动至‘体积’，点击【工具】—【用户搜索】—【定义】，选择‘按已经保存的查询搜索’，点击公式，新定义一个公式，公式的内容为：@A*@B*@C  点击【添加】。在【定义用户搜索】界面中，点击下方的【参数表】，定义参数。其中参数@A的关联字段为[Column]长度，@B的关联字段为[Column]宽度，@C的关联字段为[Column]高度。点击【确定】，勾选【自动更新】，触发更新机制为‘当退出变更列时’，下方选中[Column]物料号，点击确定

（3）回到【物料主数据】界面，输入物料号，输入长度、宽度、高度，体积自动被计算

7.

（1）打开【采购】—【申请与订单】—【采购订单】，将光标移动至‘不含税单价’，打开【工具】—【格式】—【定义突出显示样式】，输入代码、描述，将控件背景色选择红色，点击【确定】

（2）打开【工具】—【格式】—【定义突出显示】，‘突出显示字段’选择‘[Column]不含税单价’，‘显示样式’选择为刚刚定义的突出显示样式。‘背景色条件公式’需要新创建一个公式，公式内容为：

CASE

WHEN '@u'>1000

THEN 1 ELSE 0

END


将公式保存，‘文本前景色条件公式’、‘字体条件公式’均选择该公式，点击下方的【定义条件参数】，参数‘@U’的关联字段为‘[Column]不含税单价’，点击【确定】，保存【定义突出显示】

（3）回到‘采购订单’界面，手动输入一个大于1000的不含税单价，字体表现为红色。

8. 

系统菜单栏选择工具->自定义查询/报表，创建一个报表 ，SQL文本是编写sql语句查询” select DISTINCT purchOrderDetail .orderid AS 采购订单号,purchOrderDetail .Q AS 订单数量, mintd.PID AS 采购收货单号,mintd.Q AS 收货单数量,mintd.OverDate AS 收货日期

from purchOrderDetail left join  mintd on purchOrderDetail .orderid=mintd .prid and mintd .ptype=20

where 1=1”，超链接”1$160,3$20”，条件代码：“mintd.OverDate”，勾选“在拖查询中显示”

9.

（1）系统菜单栏选择工具->定义字段域，定义域业务员；

（2）系统菜单栏选择工具->管理用户字段，打开“管理，用户字段”窗口，选择采购->采购订单->明细，点击“添加”进入界面，进行定义业务员字段，填写信息。定义好后点击“复制”进入“选择复制用户字段”界面，选择勾选”收发货明细”与应付发票下的“明细”，点击确认

10.

（1）从菜单窗口，生产作业-生产作业-生产订单，打开订单创建界面；填写生产订单上信息；类型：默认，选择物料号，公司代码，勾选：自制，选择工作中心、工厂、生产总数量、计划开始时间、计划完成时间。发货方式选择‘倒冲’

（2）信息编辑完成以后，左击‘添加’按钮进行保存，并对该生产订单进行审批，审批通过后，左击‘下达’按钮；

（3）在生产订单上左击‘创建为’按钮，左击生产发货，进入生产发货界面，系统自动将信息带到生产发货界面，选择发货仓库-1000，左击‘添加’按钮，进行保存，并对生产发货进行审批，审批通过后，左击‘过账’按钮，完成生产发货出库；

（4）生产发货产生财务凭证 借：基本生产成本 855000  贷：原材料 855000

（5）在生产订单上左击‘创建为’按钮，左击生产收货，进入生产收货界面，系统自动将信息带到生产收货界面，选择收货仓库-2000，左击‘添加’按钮，进行保存，并对生产收货进行审批，审批通过后，左击‘过账’按钮，完成生产收货入库；

（6）生产收货产生财务凭证 借：库存商品 1200000  贷：生产成本转出 1200000 

11.

（1.）从菜单窗口，生产作业-生产作业-生产订单，打开订单创建界面；填写生产订单上信息；类型：默认，选择物料号，公司代码，勾选：委外，选择工作中心、工厂、生产总数量、计划开始时间、计划完成时间。勾选‘含税’，输入委外单价

（2）信息编辑完成以后，左击‘添加’按钮进行保存，并对该生产订单进行审批，审批通过后，左击‘下达’按钮；

（3）在生产订单上左击‘创建为’按钮，左击生产发货，进入生产发货界面，系统自动将信息带到生产发货界面，选择到委外仓库：3000-供应商虚拟仓库，选择发货仓库：1000-原材料仓库，左击‘添加’按钮，进行保存，并对生产发货进行审批，审批通过后，左击‘过账’按钮，委外的生产发货是将原材料仓库的原材料转移到供应商虚拟仓库的过程；

（4）生产发货产生财务凭证 借：委托加工物资 855000     贷：原材料 855000

（5）打开路径：从菜单窗口，生产作业-生产作业-委外订单下达，进行筛选页面，左击‘确认’按钮，进入委外下达界面；

（6）勾选需要转换的行，左击‘转换’按钮，系统提示：‘是否确认转换采购订单’左击‘确认’按钮，进行转换；

（7）打开路径：从菜单窗口，采购-申请与订单-采购订单，找到上一步转换的采购订单，并且审批通过，左击‘创建为’按钮，进入到采购收货界面；

（8）将采购订单下推过来的采购收货进行审批通过，左击‘过账’按钮，进行委外生产收货；

（9）采购收产生财务凭证：

借：生产成本-外发加工费 43103.45 

贷：应付账款-暂估 43103.45

借：生产成本-委托加工物资 855000

贷：委托加工物资 855000

借：库存商品 1200000

贷：生产成本差异 151896.55

贷：生产成本-外发加工费 43103.45

贷：生产成本-委托加工物资 1005000

12.

打开【销售】—【订单】—【销售订单】，选择销售类型为【赠送订单】，选择物料号，其中‘行类型’选择为‘S’，添加后发起审批

13.

（1）打开路径：从菜单窗口，固定资产-固定资产主文件，打开创建界面，并点击![img](zc_images/2.png)按钮准备创建；编辑固定资产主文件的公司、序列策略、名称以及描述；编辑固定资产主文件的详细信息在‘常规’，‘相关’，‘分配’，‘贸易伙伴’，‘折旧范围’，‘明细’，‘附加’选项卡下进行编辑；成本中心：ZZ0002，勾选：折旧范围，左击‘添加’进行保存，保存后自动生成资产编号,完成固定资产主数据的编辑。

（2）打开路径：从菜单窗口，固定资产-固定资产购置，打开创建界面，并点击![img](zc_images/3.png)准备创建；编辑购置单公司代码、货币、付款条款、税组、税后单价、成本中心以及编辑要购买的资产明细；付款条款：D/A，在‘相关’选项卡下编辑供应商信息，编辑完成，左击‘添加’按钮，审批通过后，左击‘过账’按钮，完成固定资产购置。

固定资产购置产生财务凭证 

借：固定资产-计算机  10000

借：进项税额  1600
    
贷：上海恒发科技有限公司  11600

（3）打开路径：从菜单窗口，固定资产-固定资产转移-同一费用类别的转移，打开创建界面，并点击![img](zc_images/4.png)按钮准备创建；选择公司代码、资产编号、资产名称、成本中心、到成本中心；成本中心：ZZ0002，到成本中心：ZZ0004，编辑完成后，左击‘添加’按钮，审批通过后，左击‘过账’按钮，完成同一费用类别的转移。

（4）打开路径：从菜单窗口，固定资产-固定资产折旧-普通折旧，打开创建界面，并点击![img](zc_images/5.png)按钮准备创建；选择公司、编辑资产代码从、资产代码到、会计年度、期间、勾选显示凭证，左击‘过账’按钮，系统提示：‘是否确认开始计提资产折旧’，左击‘确认’按钮，进行折旧；资产代码从：HSLFA1812050001资产代码到：HSLFA1812050001会计年度：2019，期间：1，勾选：显示凭证

14. 

（1）系统菜单选择管理->基础定义->一般->定义用户组权限，查询采购收货的全部权限值：1001026909

（2）打开sql server 2008选中数据库下的存储过程,打开”BeforeSaveCommitHandle”； 

（3）编辑内容：

IF @HandleId=1001026909

BEGIN

IF(EXISTS(SELECT * FROM  mintd WHERE ptype=20 AND ISNULL(EX38,'')='' AND pid=@PkidString	))

SET @ErrorMsg='采购收货必须来源于采购收货通知，请确认是否存在采购收货通知'

END

**附加题（15分）**

（1）打开sql server 2008选中数据库下的存储过程,打开” GetSidEx”;

（2）编辑内容：

“BEGIN--开始

   IF(@BillType=60)--判断凭证号类型

   BEGIN

   IF EXISTS(SELECT * FROM MOUTN a where a.No=@BillNo )--搜索需要干预科目的主表和干预条件
    
   BEGIN
    
   IF (@key='库存抵消-减少科目')--需要干预的科目
    
   BEGIN
    
   SET @ResultSid='500101'--干预后的科目代码
    
   END
    
   END
    
   END

 END--结束

”

（3）点击工具栏“![img](zc_images/6.png)” 执行语句；

（4）系统菜单选择库存->发货，打开“发货”窗口，创建并审批过账一个发货，结果生成财务凭证：“
借：基本生产成本
贷：原材料
”