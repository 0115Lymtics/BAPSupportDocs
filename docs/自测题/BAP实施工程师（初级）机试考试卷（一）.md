**每题10分，共100分**

1. 用户小丽希望她创建的销售订单编号与其他人创建的要有区别，并且其他人是不能使用她的编号规则，具体需求是：订单号以字母 XL 开头 + 日期格式前缀 + 4位流水号，譬如，小丽在2018年7月2日创建了第一个销售订单，订单号应该为：XL201807020001

2. 小丽还希望销售人员创建销售订单时，如果没有选择付款方式，则不允许保存，并提示用户信息：请选择付款方式

3. 用户小张是公司的物料主数据维护人员，他希望物料主数据要增加一个海关类型的字段，并且这个海关类型字段是可以下拉选择的

4. 请为销售订单配置审批流，发起人是admin用户，审批人也是admin，审批条件是：订单金额>10000元

5. 请创建一个客户主数据，并创建一个这个客户的销售订单

6. 请编写一个自定义查询，要求汇总2017年客户销售订单金额，结果：客户代码、客户名称、订单含税金额合计，（销售订单表：SaleOrder，销售订单明细表:SaleOrderDetail，客户主数据表：Customer

7. 请配置一个采购订单的打印格式，要求至少要能输出供应商名称、采购日期、采购订单号、物料号、物料名称、计量单位、数量、含税单价、含税金额。数量、单价、金额小数位设置为2位，并右对齐显示

8. 请为拖&查询中采购订单增加一个查询条件：公司代码

9. 公司总经理要求，采购收货单上的凡是价格都以*号显示或者隐藏，请配置

10. 请为某个物料定义一个标准采购价格，定义好后，在创建采购订单时系统会自动带出，请配置

###  **答案**

1、

(1)、【管理】- 【凭证编号策略】-选择销售订单-新建空白-填写缺省值XL 选择默认，序列9999添加公式代码：1000

(2)、点击【工具】-【公式编辑器】输入公式名称、公式组别并且加入代码：

CONVERT(NVARCHAR(4),RIGHT(YEAR(getdate()),4))+ CONVERT(NVARCHAR,(CASEWHENMONTH(GETDATE())<10THEN '0'+convert(nvarchar(2),MONTH(GETDATE()))elseconvert(nvarchar(2),MONTH(GETDATE()))end))+convert(nvarchar(2),day(GETDATE())) 在公式栏选择代码并且添加保存：

(3)、【管理】-【基础定义】-【定义用户】 选择小丽  【更多设置】-【分配凭证编号策略到用户】-勾选刚刚创建的凭证策略-确认并且创建销售订单进行测试

2、

打开数据库-选择可编程性-存储过程-dbo.BeforeSaveCommitHandle  点击修改增加如下代码：

  IF @HandleId=1000512909 AND (@PowerTypeId=10003 OR @PowerTypeId=10004)

BEGIN

IF(EXISTS(select * from SaleOrder where ISNULL(pwid,'')='' AND OrderId=@PkidString))

	SET @ErrorMsg='请选择付款方式'

END

3、

(1)、点击【工具】-【定义字段域】-添加海关

(2)、点击【工具】-【定义用户表】-添加表面1、描述1、数据类型无

(3)、点击【工具】-【维护用户表数据】添加标识、代码、描述

 (4)、点击【工具】-【管理用户字段】点击【恢复系统默认】

选择物料主数据 点击添加 -勾选允许为空 -勾选链接用户表 1 标签页索引0

(5)、打开【库存】-点击【屏幕变式】找到海关。是否可见：true ，控件坐标：554   63

用户选择admin

(6)、点击【高级】找到海关选择取消设置

4、

(1)、【管理】-【审批流程】-【定义审批流程】选择销售订单-选择启用 发起人选择admin

(2)、点击审批流程——增加——新建  admin--点击编辑选择--审批人选择：admin用户--点击条件 概述：含税金额总计  条件：大于> 值从  10000

5、

1、打开路径：【销售】-【客户主数据】

(1) 主表单内容

| 字段     | 内容                 |
| -------- | -------------------- |
| 代码     | C001                 |
| 名称     | 上海光明眼镜有限公司 |
| 销售组织 | 国内                 |
| 货币     | 人民币               |

(2) 会计标签页内容

| 字段     | 内容           |
| -------- | -------------- |
| 税率     | VAT16          |
| 付款条款 | 三个月（采购） |

(3) 联系人标签页内容

| 字段     | 内容         |
| -------- | ------------ |
| 姓名     | 徐建国       |
| 称谓     | 先生         |
| 电话1    | 021-89897788 |
| 移动电话 | 13806544565  |

| 字段     | 内容         |
| -------- | ------------ |
| 姓名     | 王美慧       |
| 称谓     | 女士         |
| 电话1    | 021-65488440 |
| 移动电话 | 13807655454  |

(4) 地址标签页内容

| 字段     | 内容           |
| -------- | -------------- |
| 名称     | 发运到         |
| 邮政编码 | 200000         |
| 街道     | 南京东路1200号 |
| 地区     | 黄浦区         |
| 城市     | 上海           |
| 省       | 上海（见下文） |
| 国家     | 中国           |

勾选发运到

注：定义省

    内容表

| 代码 | 名称 |
| ---- | ---- |
| 上海 | 上海 |

| 字段     | 内容           |
| -------- | -------------- |
| 名称     | 开票到         |
| 邮政编码 | 200001         |
| 街道     | 淮海西路1999号 |
| 地区     | 静安区         |
| 城市     | 上海           |
| 省       | 上海           |
| 国家     | 中国           |

勾选开票到

(5) 组织标签页内容:销售组织：勾选国内-点击【添加】按钮-点击![img](zc_images/1.png)按钮审批

2、【销售】-【销售订单】

订单类型：结算订单-选择物料 KA00001-数量：500-交货日期：3-20--添加审批

6、

【工具】-【自定义报表】-查询代码：销售报表汇总-描述：销售报表汇总-组：销售报表汇总-Sql标识 ：：销售报表汇总-描述：：销售报表汇总-格式化：2$2-汇总字段与汇总条件：2=2$2

--勾选在托查询：

select SaleOrder.Cid, SaleOrder.PartnerSummary,SaleOrderDetail.Afrom SaleOrder left join  SaleOrderDetail on  SaleOrder.OrderId = SaleOrderDetail.OrderId  where 1 = 1 

7、

(1).定义查询报表】新建:

select p.PartnerSummary '供应商名称',p1.DeliveryDate '采购日期',p1.OrderId '采购订单号',p1.Mid '物料号' ,p1.ItemSummary  '物料名称',p1.Q '数量' ,p1.UnitSummary  '计量单位',p1.AU '含税单价' ,p1.A  '含税金额' from PurchOrder p left join  PurchOrderDetail p1on p.OrderId = p1.OrderId  where 1 = 1

(2).采购】-【采购订单】-【设计打印模板】标题文本：含税单价-绑定的属性名称：含税单价

8、

【托&查询】-【采购】-【采购订单】-点【工具】-【查找条件配置】-【采购】-在表名栏中添加purchorder 字段名称栏增加CmpIdt，条件字段描述为公司代码，数据类型为文本-点击【更改】-点【采购订单】-【过滤】

9、

点击【采购】-【采购订单】-在工具栏中点【模块】-【管理】-【数据安全】

选择含有价格的字段点击【确认】

10、

点击【管理】-【基础定义】-【一般】-【定义价格组】选中【采购价格】行

双击-【日期数量折扣】-填写采购价格-创建采购订单-采购组织选择国内-采购组选择原材料